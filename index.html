<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>CureFly Global ‚Äî Hospital Finder</title>

<style>
    body {
        font-family: Arial, sans-serif;
        background: #f8f9fa;
        margin: 0;
        padding: 20px;
    }
    h1 {
        text-align: center;
        color: #2b6cb0;
    }
    .controls {
        max-width: 900px;
        margin: auto;
        display: flex;
        gap: 10px;
        justify-content: center;
        padding: 20px 0;
    }
    select, input {
        padding: 10px;
        font-size: 16px;
        width: 240px;
    }
    .hospital-card {
        background: white;
        padding: 15px;
        margin: 10px auto;
        width: 90%;
        max-width: 900px;
        border-radius: 8px;
        box-shadow: 0 3px 8px rgba(0,0,0,0.1);
    }
    .hospital-name {
        font-size: 20px;
        font-weight: bold;
        color: #2b6cb0;
        margin-bottom: 5px;
    }
    .label {
        font-weight: bold;
    }
    .no-results {
        text-align: center;
        padding: 20px;
        color: #777;
    }
</style>
</head>

<body>

<h1>CureFly Global ‚Äî NABH Hospital Finder</h1>

<div class="controls">
    <select id="citySelect">
        <option value="">Select City</option>
    </select>

    <input id="searchBox" type="text" placeholder="Search hospital..." />
</div>

<div id="results"></div>

<script>
// Load JSON from GitHub repo
const JSON_FILE = "nabh_google_enriched.json";

let allHospitals = [];
let filteredHospitals = [];

// Load Data
fetch(JSON_FILE)
    .then(res => res.json())
    .then(data => {
        allHospitals = data;
        populateCities();
        renderResults(allHospitals);
    });

// Populate City Dropdown
function populateCities() {
    const citySelect = document.getElementById("citySelect");
    const cities = [...new Set(allHospitals.map(h => h.city).filter(Boolean))].sort();

    cities.forEach(city => {
        let opt = document.createElement("option");
        opt.value = city;
        opt.textContent = city;
        citySelect.appendChild(opt);
    });
}

// Apply Filters
document.getElementById("citySelect").addEventListener("change", applyFilters);
document.getElementById("searchBox").addEventListener("keyup", applyFilters);

function applyFilters() {
    let city = document.getElementById("citySelect").value.toLowerCase();
    let keyword = document.getElementById("searchBox").value.toLowerCase();

    filteredHospitals = allHospitals.filter(h => {
        let matchesCity = !city || h.city?.toLowerCase() === city;
        let matchesKeyword = h.name?.toLowerCase().includes(keyword);
        return matchesCity && matchesKeyword;
    });

    renderResults(filteredHospitals);
}

// Render Hospital Cards
function renderResults(list) {
    const container = document.getElementById("results");
    container.innerHTML = "";

    if (list.length === 0) {
        container.innerHTML = `<div class="no-results">No hospitals found.</div>`;
        return;
    }

    list.forEach(h => {
        container.innerHTML += `
            <div class="hospital-card">
                <div class="hospital-name">${h.name}</div>
                <div><span class="label">City:</span> ${h.city || 'N/A'}</div>
                <div><span class="label">Phone:</span> ${h.phone || 'N/A'}</div>
                <div><span class="label">Rating:</span> ${h.rating || 'N/A'} ‚≠ê</div>
                <div><span class="label">Total Reviews:</span> ${h.user_ratings_total || 'N/A'}</div>
                <div><span class="label">Website:</span> <a href="${h.website || '#'}" target="_blank">${h.website || 'N/A'}</a></div>
                <div><span class="label">Nearest Airport:</span> ${h.nearest_airport || 'N/A'}</div>
                <div><a href="${h.navigation_url}" target="_blank">üìç Open in Google Maps</a></div>
            </div>
        `;
    });
}
</script>

</body>
</html>
