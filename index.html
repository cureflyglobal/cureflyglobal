<!doctype html>
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Curefly Global - Find World-Class Healthcare</title>

  <!-- Canva UI → keep Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    body { box-sizing: border-box; }
    .hospital-card { transition: transform 0.2s, box-shadow 0.2s; }
    .hospital-card:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0,0,0,0.15); }
    .star-rating { color: #fbbf24; }
  </style>
</head>

<body class="h-full bg-gradient-to-br from-blue-50 to-white font-sans">

  <!-- HEADER (unchanged Canva design) -->
  <header class="bg-white shadow-lg border-b-4 border-blue-600">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
      <div class="flex flex-col md:flex-row justify-between items-center">
        <div class="mb-4 md:mb-0">
          <h1 class="text-3xl font-bold text-blue-900">Curefly Global</h1>
          <p class="text-lg text-blue-700 mt-1">Find World-Class Healthcare</p>
        </div>

        <!-- Helpdesk -->
        <div class="flex flex-col sm:flex-row gap-4">
          <div class="text-center">
            <p class="text-sm text-gray-600">Local Helpdesk</p>
            <p class="text-lg font-semibold text-blue-900">+91-11-4567-8900</p>
          </div>
          <div class="text-center">
            <p class="text-sm text-gray-600">International Helpdesk</p>
            <p class="text-lg font-semibold text-green-700">+1-800-123-4567</p>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- SEARCH PANEL -->
  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
      <h2 class="text-2xl font-bold text-gray-900 mb-6">Search NABH Accredited Hospitals</h2>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">

        <div>
          <label class="block text-sm font-medium mb-2">Select City</label>
          <select id="city-select"
            class="w-full px-4 py-3 border border-gray-300 rounded-lg">
            <option value="">Choose a city...</option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium mb-2">Specialty (Optional)</label>
          <select id="specialty-select"
            class="w-full px-4 py-3 border border-gray-300 rounded-lg">
            <option value="">All Specialties</option>
          </select>
        </div>

        <div class="flex items-end">
          <button id="search-btn"
            class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg">
            Search Hospitals
          </button>
        </div>

      </div>
    </div>

    <!-- RESULTS -->
    <div id="results-section" class="hidden">
      <div class="flex justify-between items-center mb-6">
        <h3 class="text-2xl font-bold text-gray-900">Search Results</h3>
        <span id="results-count" class="text-gray-600"></span>
      </div>

      <div id="hospitals-grid" class="grid grid-cols-1 lg:grid-cols-2 gap-6"></div>
    </div>

    <!-- NO RESULTS -->
    <div id="no-results" class="hidden text-center py-12">
      <p class="text-gray-500 text-lg">No hospitals found.</p>
    </div>
  </main>

  <!-- MODAL -->
  <div id="hospital-modal"
       class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
    <div class="bg-white rounded-xl max-w-4xl w-full max-h-[90%] overflow-y-auto p-6">
      <div class="flex justify-between items-start mb-4">
        <h2 id="modal-hospital-name" class="text-2xl font-bold"></h2>
        <button id="close-modal" class="text-gray-500 hover:text-gray-700">
          ✕
        </button>
      </div>
      <div id="modal-content"></div>
    </div>
  </div>

  <!-- LOAD YOUR NABH DATA FILE -->
  <script type="module">
    import { hospitals as nabhList } from "./nabh_hospitals_full (1).js";

    const citySelect = document.getElementById("city-select");
    const specialtySelect = document.getElementById("specialty-select");
    const searchBtn = document.getElementById("search-btn");
    const hospitalsGrid = document.getElementById("hospitals-grid");
    const resultsSection = document.getElementById("results-section");
    const noResults = document.getElementById("no-results");
    const resultsCount = document.getElementById("results-count");

    let hospitalData = {};

    function normalize(s) {
      return (s || "").trim().toLowerCase();
    }

    // Build city → hospitals mapping
    nabhList.forEach(h => {
      const cityKey = normalize(h.city);
      if (!hospitalData[cityKey]) hospitalData[cityKey] = [];
      hospitalData[cityKey].push(h);
    });

    // Populate cities dropdown
    Object.keys(hospitalData).forEach(cityKey => {
      const opt = document.createElement("option");
      opt.value = cityKey;
      opt.textContent = cityKey.replace(/(^\w|\s\w)/g, m => m.toUpperCase());
      citySelect.appendChild(opt);
    });

    // Run search
    function search() {
      const cityKey = normalize(citySelect.value);
      if (!cityKey) {
        resultsSection.classList.add("hidden");
        noResults.classList.remove("hidden");
        return;
      }

      const list = hospitalData[cityKey] || [];

      if (!list.length) {
        resultsSection.classList.add("hidden");
        noResults.classList.remove("hidden");
        return;
      }

      resultsCount.textContent = `${list.length} hospitals`;
      noResults.classList.add("hidden");
      resultsSection.classList.remove("hidden");

      hospitalsGrid.innerHTML = list.map(h => `
        <div class="hospital-card bg-white p-6 rounded-lg shadow cursor-pointer"
             onclick="showDetails('${h.name.replace(/'/g,'')}')">
          <h3 class="text-xl font-bold mb-2">${h.name}</h3>
          <p class="text-gray-600 mb-2">${h.city}</p>
        </div>
      `).join("");
    }

    searchBtn.addEventListener("click", search);
    citySelect.addEventListener("change", search);

    // Modal
    window.showDetails = function(name) {
      const hospital = nabhList.find(h => h.name === name);
      if (!hospital) return;

      document.getElementById("modal-hospital-name").textContent = hospital.name;

      document.getElementById("modal-content").innerHTML = `
        <p><strong>City:</strong> ${hospital.city}</p>
        <p><strong>Phone:</strong> ${hospital.international_phone || "Not provided"}</p>

        <h3 class="font-bold mt-4 mb-2">Surgeries</h3>
        ${(hospital.surgeryPackages || [])
          .map(s => `<p>${s.name} — ${s.cost}</p>`)
          .join("")}
      `;

      document.getElementById("hospital-modal").classList.remove("hidden");
    };

    document.getElementById("close-modal").onclick = () =>
      document.getElementById("hospital-modal").classList.add("hidden");

  </script>

</body>
</html>
